generator client {
  provider        = "prisma-client-js" // or `prisma-client-js`
  engineType      = "client" // enable Prisma ORM without Rust
}

datasource db {
  provider = "postgresql"
}

enum LotteryStatus {
  OPEN
  CLOSED
  DRAWN
}

enum AuthProvider {
  GOOGLE
}

model User {
  id          String        @id @default(uuid())
  email       String?       @unique
  name        String?
  avatar      String?
  provider    AuthProvider
  providerId  String

  tickets     Ticket[]

  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  @@unique([provider, providerId])
}

model Lottery {
  id               String        @id @default(uuid())
  name             String
  status           LotteryStatus @default(OPEN)
  startsAt         DateTime
  endsAt           DateTime

  tickets          Ticket[]

  winnerTicketId   String?

  createdAt        DateTime @default(now())
}

model Ticket {
  id         String   @id @default(uuid())
  lotteryId  String
  userId     String

  lottery    Lottery @relation(fields: [lotteryId], references: [id])
  user       User    @relation(fields: [userId], references: [id])

  createdAt  DateTime @default(now())

  @@index([lotteryId, userId])
}
